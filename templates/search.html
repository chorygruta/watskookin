{% extends "base-layout.html" %} {% block search %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/slick.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/slick.min.css" rel="stylesheet" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/slick-theme.min.css" rel="stylesheet" />
<style>
    body {
        margin: 0;
        min-width: 60.38vw;
        font-size: 3.86vw
    }
    /* Include the padding and border in an element's total width and height */

    * {
        box-sizing: border-box;
    }
    /* Remove margins and padding from the list */

    ul {
        margin: 0;
        padding: 0;
    }
    /* Style the list items */

    ul li {
        cursor: pointer;
        position: relative;
        padding: 1.2vw 8.45vw 1.9vw 1.9vw;
        background: #eee;
        font-size: 4.8vw;
        transition: 0.2s;
        width: auto;
        margin: 0.48vw;
        display: inline-block;
        border-radius: 1.45vw;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }
    /* Set all odd list items to a different color (zebra-stripes) */

    ul li:nth-child(odd) {
        background: #f9f9f9;
    }
    /* Add a "checked" mark when clicked on */
    /* Style the close button */

    .close {
        position: absolute;
        right: 0;
        top: 0;
        padding: 1.45vw 2.9vw 1.45vw 2.9vw;
    }
    /* Style the input */

    input {
        border: none;
        width: 60%;
        padding: 2.4vw;
        float: left;
        font-size: 3.86vw;
        background-color: #eee;
        -webkit-transition: width 0.4s ease-in-out;
        transition: width 0.4s ease-in-out;
    }

    .search-wrapper {
        width: 100vw;
        position: relative;
        height: auto;
    }
    /* Style the "Add" button */

    .pantryBtn {
        margin-left: 2.4vw;
        padding: 2.4vw;
        width: 22%;
        background: #1abc9c;
        color: #fff;
        float: left;
        text-align: center;
        font-size: 3.86vw;
        cursor: pointer;
        transition: 0.3s;
    }

    .addBtn {
        padding: 2.4vw;
        width: 15%;
        background: #1abc9c;
        color: #fff;
        float: left;
        text-align: center;
        font-size: 3.86vw;
        cursor: pointer;
        transition: 0.3s;
        z-index: 2;
    }

    .word-bank {
        overflow: auto;
        width: 90vw;
        height: 27.17vh;
        margin: 2.4vw auto;
        padding: 1.2vw;
        border: 0.4vw solid grey;
    }

    .pantry {
      height: auto;
      width: 0;
      position: relative;
      z-index: 1;
      top: -10vw;
      /* left: 0; */
      background-color: #1abc9c;
      overflow-x: hidden;
      transition: 0.5s;
      text-align: center;
      /* margin-top: 10px; */
      line-height: 100%;
    }

    .pantry .closebtn {
      position: relative;
      top: 3vw;
      right: 3vw;
      font-size: 8.7vw;
      /* margin-left: 1224vw; */
      float: right;
      color: white;
    }

    section img {
        height: 11.5vh;
        width: 24.15vw;
        display: block;
        margin: 0 auto;
    }

    section div {
        margin-bottom: 2.4vw;
    }

    section {
        width: 84%;
        margin: 0 auto;
    }

    .slick-slide {
        float: left;
        height: 16.1vh;
        width: 28.74vw;
        min-height: 0.1vh;
        border: 0.1vh solid grey;
        margin: 1.2vw;
        background-color: #fff;
    }

    #snackbar {
      visibility: hidden;
      min-width: 60.38vw;
      margin: 2.4vw auto;
      background-color: #1abc9c;
      color: #fff;
      text-align: center;
      border-radius: 0.48vw;
      padding: 3.86vw;
      z-index: 1;
      position: relative;
      top: -14.5vw;
      font-size: 4.1vw;
    }

    #snackbar.show {
        visibility: visible;
        -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s;
        animation: fadein 0.5s, fadeout 0.5s 2.5s;
    }

    @-webkit-keyframes fadein {
        from {
            bottom: 0;
            opacity: 0;
        }
        to {
            bottom: 7.24vw;
            opacity: 1;
        }
    }

    @keyframes fadein {
        from {
            bottom: 0;
            opacity: 0;
        }
        to {
            bottom: 7.24vw;
            opacity: 1;
        }
    }

    @-webkit-keyframes fadeout {
        from {
            bottom: 7.24vw;
            opacity: 1;
        }
        to {
            bottom: 0;
            opacity: 0;
        }
    }

    @keyframes fadeout {
        from {
            bottom: 7.24vw;
            opacity: 1;
        }
        to {
            bottom: 0;
            opacity: 0;
        }
    }
</style>

<div id="ingredientBank" class="container-fluid word-bank">
    <ul id="myUL">
        <!--li ingredients go here-->
    </ul>
</div>

<div class="container-fluid search-wrapper">
    <div class="container-fluid" style="width:90vw; margin:0 auto;">
        <input type="text" id="myInput" placeholder="Add Ingredients">
        <span onclick="newElement()" class="addBtn">Add</span>
        <span onclick="openNav()" class="pantryBtn">Pantry</span>
    </div>
</div>

<div id="snackbar"></div>

<div id="myPantry" class="pantry">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <div style="height:5.4vh; width:100%;">
    </div>
    <section class="responsive">
        {% for i in ingredients %} {% set value = i.name %}
        <div onclick="newElementFromPantry('{{ value }}')" style="height:17.5vh; width:25.6vw;">
            <img src={{ i.imageUrl }}>
            <p>{{value}}</p>
        </div>
        {% endfor %}
    </section>
</div>

<script type="text/javascript">
    $(document).on('ready', function() {
        $('.responsive').slick({
            dots: false,
            infinite: false,
            speed: 300,
            slidesToShow: 3,
            slidesToScroll: 3,
            autoplay: true,
            autoplaySpeed: 9000
        });
    });

    function openNav() {
        document.getElementById("myPantry").style.width = "100%";
    }

    function closeNav() {
        document.getElementById("myPantry").style.width = "0";
    }

    // Create a "close" button and append it to each list item
    var myNodelist = document.getElementsByTagName("LI");
    var i;
    for (i = 0; i < myNodelist.length; i++) {
        var span = document.createElement("SPAN");
        var txt = document.createTextNode("\u00D7");
        span.className = "close";
        span.appendChild(txt);
        myNodelist[i].appendChild(span);
    }

    // Click on a close button to hide the current list item
    var close = document.getElementsByClassName("close");
    var i;
    for (i = 0; i < close.length; i++) {
        close[i].onclick = function() {
            var div = this.parentElement;
            div.style.display = "none";
        }
    }

    // Create a new list item when clicking on the "Add" button
    function newElement() {
        if (document.getElementById("myInput").value === '') {
            var x = document.getElementById("snackbar")
            x.innerHTML = "Please enter an ingredient";
            x.className = "show";
            setTimeout(function() {
                x.className = x.className.replace("show", "");
            }, 3000);
        } else {

            var check = true;
            $('#myUL').find('li').each(function() {
                var innerDivId = $(this).text();
                innerDivId = innerDivId.slice(0, -1);

                if (innerDivId.toLowerCase() === document.getElementById("myInput").value.toLowerCase())
                    check = false;
            });

            if (check) {

                var out = document.getElementById("ingredientBank");
                var li = document.createElement("li");
                var inputValue = document.getElementById("myInput").value;
                var isScrolledToBottom = out.scrollHeight - out.clientHeight <= out.scrollTop + 1;
                var t = document.createTextNode(inputValue);
                li.appendChild(t);
                document.getElementById("myUL").appendChild(li);

                document.getElementById("myInput").value = "";

                var span = document.createElement("SPAN");
                var txt = document.createTextNode("\u00D7");
                span.className = "close";
                span.appendChild(txt);
                li.appendChild(span);

                if (isScrolledToBottom)
                    out.scrollTop = out.scrollHeight - out.clientHeight;

                for (i = 0; i < close.length; i++) {
                    close[i].onclick = function() {
                        var div = this.parentElement;
                        div.style.display = "none";
                    }
                }
            } else {
                var x = document.getElementById("snackbar")
                x.innerHTML = "'" + document.getElementById("myInput").value + "' has already been added";
                x.className = "show";
                setTimeout(function() {
                    x.className = x.className.replace("show", "");
                }, 3000);
            }
        }
    }


    function newElementFromPantry(name) {
        var out = document.getElementById("ingredientBank");
        var li = document.createElement("li");
        var inputValue = name;

        var check = true;
        $('#myUL').find('li').each(function() {
            var innerDivId = $(this).text();
            innerDivId = innerDivId.slice(0, -1);
            if (innerDivId.toLowerCase() === name.toLowerCase())
                check = false;
        });

        if (check) {

            var isScrolledToBottom = out.scrollHeight - out.clientHeight <= out.scrollTop + 1;

            var t = document.createTextNode(inputValue);
            li.appendChild(t);
            if (inputValue === '') {
                alert("No Ingredient Entered!");
            } else {
                document.getElementById("myUL").appendChild(li);
            }
            document.getElementById("myInput").value = "";

            var span = document.createElement("SPAN");
            var txt = document.createTextNode("\u00D7");
            span.className = "close";
            span.appendChild(txt);
            li.appendChild(span);

            if (isScrolledToBottom)
                out.scrollTop = out.scrollHeight - out.clientHeight;

            for (i = 0; i < close.length; i++) {
                close[i].onclick = function() {
                    var div = this.parentElement;
                    div.style.display = "none";
                }
            }
        } else {
            var x = document.getElementById("snackbar")
            x.innerHTML = "'" + name + "' has already been added";
            x.className = "show";
            setTimeout(function() {
                x.className = x.className.replace("show", "");
            }, 3000);
        }
    }
</script>
{% endblock %}
